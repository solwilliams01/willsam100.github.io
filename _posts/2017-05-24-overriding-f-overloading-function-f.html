---
layout: post
title: Overriding functions and overloading functions in F#
date: 2017-05-24 19:52:26.000000000 +12:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Code
tags:
- F#
- functional programming
- OOP
meta:
  _edit_last: '1'
  mashsb_timestamp: '1590833717'
  mashsb_shares: '0'
  mashsb_jsonshares: '{"total":0,"error":"","facebook_shares":0}'
  mashsb_shorturl: http://www.codingwithsam.com/overriding-methodsfunctions-in-f/
  mashsb_twitter_handle: willsam100
  _yoast_wpseo_primary_category: '47'
  ampforwp_custom_content_editor: ''
  ampforwp_custom_content_editor_checkbox: ''
  ampforwp-amp-on-off: default
  _yoast_wpseo_metadesc: Overloading methods is common practice in OOP. OVerride functions,
    as well as overloading functions in F# is a little different. Here is the needed
    keyword
  _yoast_wpseo_content_score: '30'
  dsq_thread_id: '6141489708'
  _wp_old_slug: overriding-methodsfunctions-in-f
author:
  login: sam
  email: willsam100@gmail.com
  display_name: Sam Williams
  first_name: Sam
  last_name: Williams
permalink: "/2017/05/24/overriding-f-overloading-function-f/"
---
<p>Overloading methods are common practice in many OOP languages, but in functional languages (using a functional style) not only is this not common practice, sometimes it's not even possible. This short post highlights why and shows the alternatives.</p>
<p><strong>prerequisites</strong></p>
<ul>
<li>A simple understanding of an OOP language (C# or Java)</li>
<li>A simple understanding of a functional programming language. (Code examples are in F#)</li>
</ul>
<p><strong>The Problem</strong></p>
<p>As always we need some code to talk about. Here's some OOP style using F#</p>
<table class="pre">
<tbody>
<tr>
<td class="lines">
<pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
</pre>
</td>
<td class="snippet">
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span class="rt">LibraryClass</span><span class="pn">(</span><span class="pn">)</span> <span class="o">=</span> 

    <span class="k">member</span> <span class="id">this</span><span class="pn">.</span><span class="fn">PrintNumber</span> <span class="pn">(</span><span class="id">myNumber</span><span class="pn">:</span> <span class="vt">int</span><span class="pn">)</span><span class="pn">:</span> <span class="rt">unit</span> <span class="o">=</span> 
        <span class="fn">printfn</span> <span class="s">"</span><span class="pf">%f</span><span class="s">"</span> <span class="pn">(</span><span class="fn">float</span> <span class="id">myNumber</span><span class="pn">)</span>
    <span class="k">member</span> <span class="id">this</span><span class="pn">.</span><span class="fn">PrintNumber</span> <span class="pn">(</span><span class="id">myNumber</span><span class="pn">:</span> <span class="vt">float</span><span class="pn">)</span><span class="pn">:</span> <span class="rt">unit</span> <span class="o">=</span> 
        <span class="fn">printfn</span> <span class="s">"</span><span class="pf">%f</span><span class="s">"</span> <span class="pn">(</span><span class="fn">float</span> <span class="id">myNumber</span><span class="pn">)</span>

<span class="c">// Using class</span>
<span class="k">let</span> <span class="id">myLibrary</span> <span class="o">=</span> <span class="k">new</span> <span class="rt">LibraryClass</span><span class="pn">(</span><span class="pn">)</span>
<span class="fn">myLibrary</span><span class="pn">.</span><span class="id">PrintNumber</span> <span class="n">10</span>
<span class="fn">myLibrary</span><span class="pn">.</span><span class="id">PrintNumber</span> <span class="n">10.0</span>
</code></pre>
</td>
</tr>
</tbody>
</table>
<p>No surprises here, everything works as expected. So what happens if we want to write this in more of a functional style. Here's a first attempt:</p>
<table class="pre">
<tbody>
<tr>
<td class="lines">
<pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
</pre>
</td>
<td class="snippet">
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">module</span> <span class="m">Library</span> <span class="o">=</span> 
    <span class="c">// Does not compile</span>
    <span class="k">let</span> <span class="fn">PrintNumber</span> <span class="pn">(</span><span class="id">myNumber</span><span class="pn">:</span> <span class="vt">int</span><span class="pn">)</span> <span class="o">=</span> 
        <span class="fn">printfn</span> <span class="s">"</span><span class="pf">%f</span><span class="s">"</span> <span class="pn">(</span><span class="fn">float</span> <span class="id">myNumber</span><span class="pn">)</span>
    <span class="k">let</span> <span class="fn">PrintNumber</span> <span class="pn">(</span><span class="id">myNumber</span><span class="pn">:</span> <span class="vt">float</span><span class="pn">)</span> <span class="o">=</span> 
        <span class="fn">printfn</span> <span class="s">"</span><span class="pf">%f</span><span class="s">"</span> <span class="pn">(</span><span class="fn">float</span> <span class="id">myNumber</span><span class="pn">)</span>
</code></pre>
</td>
</tr>
</tbody>
</table>
<p><em>This does not compile</em> and gives and the error <em>Duplicate definition of value 'PrintNumber'.</em> Argh, at first glance this would appear like F# is missing some basic machinery.</p>
<p><strong>Discussion</strong></p>
<p>The reason why this is happening is that the F# compiler cannot determine the difference between the functions. Either the name needs to be changed or the number of parameters. If each function is rather different in nature then changing the name might be a better way to go. However, if your design is pretty good, then chances are these functions should have the same name.</p>
<p><strong>Last Effort</strong></p>
<p>Here is the final effort and fortunately this code compiles:</p>
<table class="pre">
<tbody>
<tr>
<td class="lines">
<pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre>
</td>
<td class="snippet">
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">module</span> <span class="id">Library</span> <span class="o">=</span> 

    <span class="k">let</span> <span class="k">inline</span> <span class="id">printNumber</span> <span class="id">myNumber</span> <span class="o">=</span> 
        <span class="id">printfn</span> <span class="s">"%f"</span> <span class="pn">(</span><span class="id">float</span> <span class="id">myNumber</span><span class="pn">)</span>

<span class="id">Library</span><span class="pn">.</span><span class="id">printNumber</span> <span class="n">10</span>
<span class="id">Library</span><span class="pn">.</span><span class="id">printNumber</span> <span class="n">10.0</span>
</code></pre>
</td>
</tr>
</tbody>
</table>
<p>The keyword <code>inline</code> comes to the rescue. <code>inline</code> can be used to relax the type inference on a function, despite the implementation not doing anything related to this. When the compiler reads <code>inline</code>, instead of creating a function, it replaces the caller with the function itself, ie it 'inlines' the function. <code>inline</code> can also be used for performance-related tasks as a last effort. For a full read see <a title="https://docs.microsoft.com/en-us/dotnet/articles/fsharp/language-reference/functions/inline-functions">Inline Functions</a>.</p>
<p>As a result, when a function is inlined, its type inference is the most general it can be. I think a quote is relevant here</p>
<blockquote><p>With great power comes great responsibility</p></blockquote>
<p>Use <code>inline</code> sparingly, only to make the code more readable. As a guideline, the types of the inlined function should still have some restriction, not obj -&gt; obj. If you have this as a problem, find a way to restrict the types. Perhaps by using a discriminated union (DU) and passing that through, but each case will differ.</p>
<p>Now you can use this with iOS and Android, where overriding and overloading typically can't be avoided. <a href="http://www.codingwithsam.com/2017/08/15/android-and-f-are-at-last-friends/">Android and F# are at last friends</a></p>
<div id="fs1" class="tip">Multiple items<br />
type LibraryClass =<br />
new : unit -&gt; LibraryClass<br />
member PrintNumber : myNumber:int -&gt; unit<br />
member PrintNumber : myNumber:float -&gt; unit</p>
<p>Full name: Inline.LibraryClass</p>
<p>--------------------<br />
new : unit -&gt; LibraryClass</p>
</div>
<div id="fs2" class="tip">val this : LibraryClass</div>
<div id="fs3" class="tip">val myNumber : int</div>
<div id="fs4" class="tip">Multiple items<br />
val int : value:'T -&gt; int (requires member op_Explicit)</p>
<p>Full name: Microsoft.FSharp.Core.Operators.int</p>
<p>--------------------<br />
type int = int32</p>
<p>Full name: Microsoft.FSharp.Core.int</p>
<p>--------------------<br />
type int&lt;'Measure&gt; = int</p>
<p>Full name: Microsoft.FSharp.Core.int&lt;_&gt;</p>
</div>
<div id="fs5" class="tip">type unit = Unit</p>
<p>Full name: Microsoft.FSharp.Core.unit</p>
</div>
<div id="fs6" class="tip">val printfn : format:Printf.TextWriterFormat&lt;'T&gt; -&gt; 'T</p>
<p>Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.printfn</p>
</div>
<div id="fs7" class="tip">Multiple items<br />
val float : value:'T -&gt; float (requires member op_Explicit)</p>
<p>Full name: Microsoft.FSharp.Core.Operators.float</p>
<p>--------------------<br />
type float = System.Double</p>
<p>Full name: Microsoft.FSharp.Core.float</p>
<p>--------------------<br />
type float&lt;'Measure&gt; = float</p>
<p>Full name: Microsoft.FSharp.Core.float&lt;_&gt;</p>
</div>
<div id="fs8" class="tip">val myNumber : float</div>
<div id="fs9" class="tip">val myLibrary : LibraryClass</p>
<p>Full name: Inline.myLibrary</p>
</div>
<div id="fs10" class="tip">member LibraryClass.PrintNumber : myNumber:int -&gt; unit<br />
member LibraryClass.PrintNumber : myNumber:float -&gt; unit</div>
<div id="fs11" class="tip">val PrintNumber : myNumber:int -&gt; unit</p>
<p>Full name: Inline.Library.PrintNumber</p>
</div>
<div id="fs12" class="tip">val PrintNumber : myNumber:float -&gt; unit</p>
<p>Full name: Inline.Library.PrintNumber</p>
</div>
<div id="fs13" class="tip">module Library</p>
<p>from Inline</p>
</div>
